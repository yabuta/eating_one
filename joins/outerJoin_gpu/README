outerとinnerはほぼ同じ実装になるらしいので必要になったらinner joinのプログラムを書き換えることにする